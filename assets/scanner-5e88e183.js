import{b as C}from"./verifySession-bdf483da.js";import{C as S}from"./CardBasic-f04f2f72.js";import{y as k}from"./side-effects-16dd37a6.js";import{b as h,c as y,q as B,w as D,a as g}from"./firebase-da6e628f.js";import{r,a$ as E,o as t,c as n,a as i,P as l,R as w,bd as I,e as M}from"./index-ba7efa84.js";import"./DemoFormLayoutMultipleColumn-2ce41123.js";import"./VRow-bf744c0d.js";import"./VCol-be91beef.js";import"./VAlert-8122022d.js";import"./VAvatar-f72d3f84.js";import"./VImg-86c86b93.js";import"./VTextField-3660a98e.js";import"./forwardRefs-9d31fcaa.js";import"./index-beb39f3d.js";import"./VSelect-ead6db5f.js";import"./VMenu-1b77b7ed.js";import"./VDivider-f5c08ea2.js";import"./VOverlay-31578629.js";import"./dialog-transition-4730997b.js";import"./VCheckboxBtn-13042f47.js";import"./VChip-1538c857.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./VCard-f2d7cbd6.js";import"./VDialog-09695396.js";const N={key:0,class:"container-fluid m-0 p-0"},P={ref:"video",autoplay:"",class:"w-100 mb-0 pb-0"},R={key:1,class:"container-fluid mt-3"},V={class:"row"},F={class:"col-12 p-4"},$={key:0,class:"text-center"},j=i("p",{class:"alert alert-danger"},"Codigo de barra no registrado",-1),le={__name:"scanner",props:{search:{type:null,required:!0}},setup(z){const u=r([]),p=r(!1),d=r(!0),m=r([]),v=r([]),_=r(),f=r(!1),q=()=>{window.location.reload()};E(async()=>{C();const c=document.querySelector("video"),a={video:{facingMode:"environment"}};(await h(y(g,"proveedores"))).forEach(e=>{m.value.push({...e.data(),id:e.id}),v.value.push({...e.data(),id:e.id})}),navigator.mediaDevices.getUserMedia(a).then(e=>{c.srcObject=e,c.play(),x()}).catch(e=>{console.error("Error accessing camera:",e)})});async function x(){const c=document.querySelector("video"),a=new k({formats:["qr_code","ean_13","code_128","aztec","code_39","code_93","codabar","databar","databar_expanded","data_matrix","dx_film_edge","ean_8","itf","maxi_code","micro_qr_code","pdf417","rm_qr_code","upc_a","upc_e","linear_codes","matrix_codes"]}),o=setInterval(async()=>{const e=await a.detect(c);if(e.length>0){clearInterval(o);const b=await h(B(y(g,"inventario"),D("barcode","==",e[0].rawValue)));d.value=!1,p.value=!0,b.empty?(d.value=!0,f.value=!0):(b.forEach(async s=>{u.value.push({...s.data(),id:s.id}),_.value=s.data().proveedor}),m.value=v.value.filter(s=>s.id.includes(_.value)))}},1e3)}return(c,a)=>(t(),n(w,null,[d.value?(t(),n("div",N,[i("video",P,null,512)])):l("",!0),p.value?(t(),n("div",R,[i("div",V,[(t(!0),n(w,null,I(u.value,o=>(t(),M(S,{card:{name:o.name,description:o.description,count:o.count,price:o.price,priceSale:o.priceSale,img:o.image,buttonSale:!1,priceCosto:!0}},null,8,["card"]))),256)),i("div",F,[f.value?(t(),n("div",$,[j,i("button",{class:"btn btn-success mb-2",onClick:a[0]||(a[0]=o=>q())},"Reiniciar Scanner")])):l("",!0)])])])):l("",!0)],64))}};export{le as default};
